<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Angular Controllers</title>
    <!-- Add the AngularJS CDN below -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>


</head>
<body ng-app="angControl">
    <div ng-controller="formController as fc">
        <input type="text" ng-model="fc.form.fname" placeholder="First Name"><br>
        <input type="text" ng-model="fc.form.lname" placeholder="Last Name"><br>
        <input type="text" ng-model="fc.form.email" placeholder="email"><br>
        <textarea ng-model="fc.form.comments" placeholder="comments" ng-disabled="fc.charsAvail()"></textarea>
        <p>Remaining Chars: {{fc.checkAvailable()}}</p>
        <button type="button" ng-click="fc.addForm()">Submit</button>
        <hr>
        <div ng-controller = "tableController as tc">
            <p>Total Number of Entries: {{tc.totalEntries()}}</p>
            <table>
                <tbody>
                    <tr>
                        <th>Full Name</th>
                        <th>Email</th>
                        <th>Comments</th>
                        <th>Delete</th>
                    </tr>
                    <tr ng-repeat = 'f in forms'>
                        <td>{{f.fname + " " + f.lname}}</td>
                        <td>{{f.email}}</td>
                        <td>{{f.comments}}</td>
                        <td><button type="button" ng-click="tc.removeRow($index)">Delete {{$index}}</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
<script>
    var app = angular.module('angControl',[]);
    app.controller('formController',function($scope){
        this.maxCommentLength = 25;
        this.form = {
            fname:'',
            lname:'',
            email:'',
            comments:''
        };
        $scope.forms = [
            {fname:'Korey',
            lname:'Lo',
            email:'koreylo@gmail.com',
            comments:"TSM shoulda won"}
        ];
        this.addForm = function(){
            $scope.forms.push(this.form);
            this.form = {};
        };
        this.checkAvailable = function(){
            if(this.form.comments === undefined){
                this.form.comments = '';
            }
            return this.maxCommentLength - this.form.comments.length;
        };
        this.charsAvail = function(){
            var check = this.checkAvailable();
            if(check <= 0){
                return true;
            }
            else{
                return false;
            }
        }
    });

    app.controller('tableController',function($scope){
        this.removeRow = function(index){
            $scope.forms.splice(index,1);
        };
        this.totalEntries = function(){
            return $scope.forms.length;
        }


    })
</script>
</html>